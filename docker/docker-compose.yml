#
# GENERATED BY docker/init.sh - template: ./templates/docker-compose.yml - ab5af06c39cac1c75ffb16f2f8d36b65
#
# ======================================================================
#
# (1) see .env for set variables
# (2) run "docker-compose up" to startup
# 
# ======================================================================
version: '3.9'

networks:
  appmonitornetwork:

services:

  # ----- apache httpd + php
  web-server:
    build:
      context: .
      dockerfile: ./containers/web-server/Dockerfile
    image: "php:8.1-apache"
    container_name: 'appmonitor-server'
    ports:
      - '${APP_PORT}:80'

    working_dir: ${WEBROOT}
    
    volumes:
      - ../:/var/www/${APP_NAME}
      - ./containers/web-server/apache/sites-enabled:/etc/apache2/sites-enabled
      - ./containers/web-server/php/extra-php-config.ini:/usr/local/etc/php/conf.d/extra-php-config.ini
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost"]
      interval: 10s
      timeout: 3s
      retries: 5
      # start_period: 40s

    networks:
      - appmonitornetwork

    user: ${DOCKER_USER_UID}

